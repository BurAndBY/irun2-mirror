{% extends "base.html" %}

{% load staticfiles %}
{% load i18n %}

{% get_current_language as LANGUAGE_CODE %}

{% block content %}

<script>
var irSourceData = {{ tree_data|safe }};

$(document).ready(function() {
    $("#datatable").DataTable({
        "language": {
            "url": "{% static 'DataTables-1.10.10/i18n' %}/{{ LANGUAGE_CODE }}.json"
        },
        "autoWidth": false,
        {% if table_data %}
            "data": {{ table_data|safe }}
        {% endif %}
    });

    var fancyTree = $("#tree").fancytree({
        source: irSourceData,
        minExpandLevel: 2
    });

    {% if cur_folder_id %}
        $("#tree").fancytree("getTree").activateKey("{{ cur_folder_id }}");
    {% endif %}

    fancyTree.bind("fancytreeactivate", function(event, data) {
        var node = data.node;
        var urlMask = "{% url 'problems:show_folder_json' 12345 %}".replace(/12345/, node.key.toString());
        $("#datatable").dataTable().api().ajax.url(urlMask).load();
    });
});
</script>

<div class="row">
    <div class="col-md-3">
        <div id="tree"></div>
    </div>
    <div class="col-md-9">
        <table id="datatable" class="table table-striped table-condensed table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Full Name</th>
                </tr>
            </thead>
        </table>
    </div>
</div>

{% endblock %}
